class VideoPlayer{constructor(e={}){if(this.config={videoContainerId:e.videoContainerId||"video-container",controls:{playPause:e.controls?.playPause??!0,volume:e.controls?.volume??!0,fullscreen:e.controls?.fullscreen??!0,speed:e.controls?.speed??!0,progressBar:e.controls?.progressBar??!0,centerPlayPause:e.controls?.centerPlayPause??!0},defaultVolume:e.defaultVolume||1,defaultSpeed:e.defaultSpeed||1,speedOptions:e.speedOptions||[.5,1,1.5,2],hideControlsTimeout:e.hideControlsTimeout||2e3,showCards:e.showCards??!0,hideCardsTimeout:e.hideCardsTimeout||2e3},this.videoContainer=document.getElementById(this.config.videoContainerId),this.videoCards=document.querySelectorAll(".FVideoPlayerCard"),this.video=document.getElementById("FVideoPlayer"),this.controls={},this.hideControlsTimeout=null,this.videoContainer&&this.video){if(e.videoSrc)this.config.videoSrc=e.videoSrc;else{const e=this.video.querySelector("source");if(!e||!e.src)return void console.error("Video source not found in video tag!");this.config.videoSrc=e.src}this.init()}else console.error("Video-container or FVideoPlayer element not found!")}init(){this.insertLoadingSpinnerHTML(),this.insertControlsHTML(),this.setupVideo(),this.setupControls(),this.setupEventListeners(),this.setupLoadingSpinner(),config.showCards&&this.setupVideoCards(),this.setupKeyboardShortcuts()}insertLoadingSpinnerHTML(){this.videoContainer.insertAdjacentHTML("afterbegin",'\n        <div id="FVideoPlayerLoadingSpinner" class="FVideoPlayerLoadingSpinner">\n            <div class="FVideoPlayerSpinner"></div>\n        </div>')}insertControlsHTML(){const e=`\n            <div id="FVideoPlayerCenterPlayPause">\n                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" id="FVideoPlayerCenterPlayIcon">\n                    <path d="M8 5v14l11-7z" fill="white"/>\n                </svg>\n                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" id="FVideoPlayerCenterPauseIcon" style="display:none;">\n                    <path d="M6 19h4V5H6zm8 0h4V5h-4z" fill="white"/>\n                </svg>\n            </div>\n            <div class="FVideoPlayerControls">\n                <div class="FVideoPlayerControls-top-section">\n                    <input type="range" id="progress-bar" min="0" max="100" step="0.01" value="0">\n                </div>\n                <div class="FVideoPlayerControls-bottom-section">\n                    <div class="FVideoPlayerControls-bottom-section-start">\n                        <button id="play-pause-btn">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="play-icon">\n                                <path d="M8 5v14l11-7z"/>\n                            </svg>\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="pause-icon" style="display:none;">\n                                <path d="M6 19h4V5H6zm8 0h4V5h-4z"/>\n                            </svg>\n                        </button>\n                        <div style="display: flex">\n                            <span id="current-time">00:00</span>\n                            <span style="margin: 0 5px">/</span>\n                            <span id="duration-time">00:00</span>\n                        </div>\n                    </div>\n\n                    <div class="FVideoPlayerControls-bottom-section-end">\n                        <button id="speed-btn">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n                                <path d="M3 16a9 9 0 0 1 18 0" stroke="white" stroke-width="2" fill="none" />\n                                <line x1="12" y1="16" x2="16" y2="10" stroke="white" stroke-width="2" stroke-linecap="round" />\n                            </svg>\n                        </button>\n                        <div id="speed-options" class="dropdown-menu">\n                            ${this.config.speedOptions.map((e=>`\n                                <button class="dropdown-item" data-speed="${e}" ${e===this.config.defaultSpeed?'style="background-color: rgb(0, 123, 255);"':""}>${e}x</button>\n                            `)).join("")}\n                        </div>\n\n                        <div id="volume-control">\n                            <button id="mute-btn">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="unmute-icon">\n                                    <path d="M12 3v18l-6-6H4V9h2l6-6z" fill="white"/>\n                                    <path d="M15 7c3 3 3 7 0 10" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"/>\n                                    <path d="M18 4c4.5 4.5 4.5 11 0 15" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"/>\n                                </svg>\n                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="mute-icon" style="display:none;">\n                                    <path d="M12 3v18l-6-6H4V9h2l6-6z"/>\n                                    <line x1="20" y1="4" x2="4" y2="20" stroke="white" stroke-width="2"/>\n                                </svg>\n                            </button>\n                            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="${this.config.defaultVolume}">\n                        </div>\n\n                        <button id="fullscreen-btn">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="fullscreen-icon">\n                                <path d="M7 7h4v2H7v4H5V7zm10 0h-4v2h4v4h2V7zm-10 10h4v-2H7v-4H5v6zm10 0h-4v-2h4v-4h2v6z"/>\n                            </svg>\n                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" id="exit-fullscreen-icon" style="display:none;">\n                                <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>\n                            </svg>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;this.videoContainer.insertAdjacentHTML("beforeend",e),this.controls={playPauseBtn:document.getElementById("play-pause-btn"),playIcon:document.getElementById("play-icon"),pauseIcon:document.getElementById("pause-icon"),muteBtn:document.getElementById("mute-btn"),unmuteIcon:document.getElementById("unmute-icon"),muteIcon:document.getElementById("mute-icon"),fullscreenBtn:document.getElementById("fullscreen-btn"),fullscreenIcon:document.getElementById("fullscreen-icon"),exitFullscreenIcon:document.getElementById("exit-fullscreen-icon"),volumeSlider:document.getElementById("volume-slider"),progressBar:document.getElementById("progress-bar"),currentTimeElem:document.getElementById("current-time"),durationTimeElem:document.getElementById("duration-time"),speedBtn:document.getElementById("speed-btn"),speedMenu:document.getElementById("speed-options"),speedItems:document.querySelectorAll(".dropdown-item[data-speed]"),centerPlayPause:document.getElementById("FVideoPlayerCenterPlayPause"),centerPlayIcon:document.getElementById("FVideoPlayerCenterPlayIcon"),centerPauseIcon:document.getElementById("FVideoPlayerCenterPauseIcon"),volumeControl:document.getElementById("volume-control"),FVideoPlayerControls:document.querySelector(".FVideoPlayerControls")}}setupVideo(){this.video.src=this.config.videoSrc,this.video.volume=this.config.defaultVolume,this.video.playbackRate=this.config.defaultSpeed}setupControls(){config.controls.playPause||(this.controls.playPauseBtn.style.display="none"),config.controls.volume||(this.controls.volumeControl.style.display="none"),config.controls.fullscreen||(this.controls.fullscreenBtn.style.display="none"),config.controls.speed||(this.controls.speedBtn.style.display="none"),config.controls.progressBar||(this.controls.progressBar.style.display="none"),config.controls.centerPlayPause||(this.controls.centerPlayPause.style.display="none")}setupEventListeners(){this.controls.fullscreenBtn.addEventListener("click",(()=>this.toggleFullscreen())),this.video.addEventListener("dblclick",(()=>this.toggleFullscreen())),this.controls.playPauseBtn.addEventListener("click",(()=>this.togglePlayPause())),this.video.addEventListener("click",(()=>this.togglePlayPause())),this.controls.muteBtn.addEventListener("click",(()=>this.toggleMute())),this.controls.volumeSlider.addEventListener("input",(()=>this.adjustVolume())),this.controls.progressBar.addEventListener("input",(()=>this.seekVideo())),this.video.addEventListener("timeupdate",(()=>this.updateProgress())),this.video.addEventListener("ended",(()=>this.videoEnded())),this.controls.speedBtn.addEventListener("click",(e=>this.toggleSpeedMenu(e))),this.controls.speedItems.forEach((e=>e.addEventListener("click",(()=>this.changeSpeed(e))))),document.addEventListener("click",(e=>this.hideSpeedMenu(e))),this.video.addEventListener("mousemove",(()=>this.showControls())),this.video.addEventListener("click",(()=>this.showControls())),this.controls.centerPlayPause.addEventListener("click",(()=>this.togglePlayPause())),this.video.addEventListener("fullscreenchange",(()=>this.adjustVideoSize())),this.controls.volumeControl.addEventListener("mouseleave",(()=>this.hideVolumeSlider())),this.video.addEventListener("contextmenu",(e=>{e.preventDefault()})),this.controls.FVideoPlayerControls.addEventListener("contextmenu",(e=>{e.preventDefault()}))}setupLoadingSpinner(){this.loadingSpinner=document.getElementById("FVideoPlayerLoadingSpinner"),this.loadingSpinner?(this.video.addEventListener("waiting",(()=>{this.loadingSpinner.style.display="block"})),this.video.addEventListener("canplay",(()=>{this.loadingSpinner.style.display="none"})),this.video.addEventListener("seeking",(()=>{this.loadingSpinner.style.display="block"})),this.video.addEventListener("seeked",(()=>{this.loadingSpinner.style.display="none"})),this.video.addEventListener("stalled",(()=>{this.loadingSpinner.style.display="block"})),this.video.addEventListener("playing",(()=>{this.loadingSpinner.style.display="none"}))):console.error("FVideoPlayerLoadingSpinner element not found!")}setupVideoCards(){this.videoCards.forEach((e=>{const t=e.getAttribute("data-card-time").split(":").map(Number).reverse(),n=(t[0]||0)+60*(t[1]||0)+3600*(t[2]||0);e.style.display="none",this.video.addEventListener("timeupdate",(()=>{Math.floor(this.video.currentTime)===n&&(e.style.display="block",setTimeout((()=>{e.style.display="none"}),this.config.hideCardsTimeout))}))}))}setupKeyboardShortcuts(){document.addEventListener("keydown",(e=>{switch(e.key){case" ":this.togglePlayPause();break;case"f":this.toggleFullscreen();break;case"ArrowRight":this.video.currentTime+=5;break;case"ArrowLeft":this.video.currentTime-=5;break;case"ArrowUp":this.video.volume=Math.min(this.video.volume+.1,1);break;case"ArrowDown":this.video.volume=Math.max(this.video.volume-.1,0);break;case"m":this.video.muted=!this.video.muted}}))}togglePlayPause(){this.video.paused?(this.video.play(),this.controls.playIcon.style.display="none",this.controls.pauseIcon.style.display="inline",this.controls.centerPlayIcon.style.display="none",this.controls.centerPauseIcon.style.display="none"):(this.video.pause(),this.controls.playIcon.style.display="inline",this.controls.pauseIcon.style.display="none",this.controls.centerPlayIcon.style.display="inline",this.controls.centerPauseIcon.style.display="none"),this.showControls()}toggleMute(){this.video.muted=!this.video.muted,this.video.muted||0===this.video.volume?(this.controls.muteIcon.style.display="inline",this.controls.unmuteIcon.style.display="none"):(this.controls.muteIcon.style.display="none",this.controls.unmuteIcon.style.display="inline"),this.showControls()}toggleFullscreen(){document.fullscreenElement?(this.controls.fullscreenIcon.style.display="inline",this.controls.exitFullscreenIcon.style.display="none",document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),screen.orientation.unlock()):(this.controls.fullscreenIcon.style.display="none",this.controls.exitFullscreenIcon.style.display="inline",this.videoContainer.requestFullscreen?this.videoContainer.requestFullscreen():this.videoContainer.mozRequestFullScreen?this.videoContainer.mozRequestFullScreen():this.videoContainer.webkitRequestFullscreen?this.videoContainer.webkitRequestFullscreen():this.videoContainer.msRequestFullscreen&&this.videoContainer.msRequestFullscreen(),window.innerHeight>window.innerWidth&&screen.orientation.lock("landscape").catch((function(e){console.log("Error locking orientation:",e)})))}adjustVolume(){this.video.volume=this.controls.volumeSlider.value,0===this.video.volume||this.video.muted?(this.controls.muteIcon.style.display="inline",this.controls.unmuteIcon.style.display="none"):(this.controls.muteIcon.style.display="none",this.controls.unmuteIcon.style.display="inline"),this.showControls()}seekVideo(){const e=this.controls.progressBar.value/100*(isNaN(this.video.duration)?0:this.video.duration);this.video.currentTime=e,this.video.currentTime===this.video.duration&&(this.controls.playIcon.style.display="inline",this.controls.pauseIcon.style.display="none")}updateProgress(){let e=this.video.currentTime/(isNaN(this.video.duration)?0:this.video.duration)*100;e=isNaN(e)?0:e,this.controls.progressBar.value=e.toFixed(2),this.controls.currentTimeElem.textContent=this.formatTime(this.video.currentTime),this.controls.durationTimeElem.textContent=isNaN(this.video.duration)?"00:00":this.formatTime(this.video.duration)}videoEnded(){this.controls.playIcon.style.display="inline",this.controls.pauseIcon.style.display="none",this.controls.centerPlayIcon.style.display="inline",this.controls.centerPauseIcon.style.display="none"}toggleSpeedMenu(e){e.stopPropagation(),this.controls.speedMenu.style.display="block"===this.controls.speedMenu.style.display?"none":"block"}changeSpeed(e){const t=parseFloat(e.getAttribute("data-speed"));this.video.playbackRate=t,this.controls.speedItems.forEach((e=>e.style.backgroundColor="")),e.style.backgroundColor="#007BFF",this.controls.speedMenu.style.display="none"}hideSpeedMenu(e){this.controls.speedBtn.contains(e.target)||this.controls.speedMenu.contains(e.target)||(this.controls.speedMenu.style.display="none")}showControls(){clearTimeout(this.hideControlsTimeout),this.controls.FVideoPlayerControls.classList.add("visible"),this.hideControlsTimeout=setTimeout((()=>{this.controls.FVideoPlayerControls.classList.remove("visible")}),config.hideControlsTimeout)}adjustVideoSize(){document.fullscreenElement?(this.video.style.width="100%",this.video.style.height="100%"):(this.video.style.width="auto",this.video.style.height="auto")}hideVolumeSlider(){this.controls.volumeControl.classList.remove("show-slider")}formatTime(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%60);return t>0?`${t<10?"0":""}${t}:${n<10?"0":""}${n}:${o<10?"0":""}${o}`:`${n<10?"0":""}${n}:${o<10?"0":""}${o}`}}